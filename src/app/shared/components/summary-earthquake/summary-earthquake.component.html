<!-- MODAL -->
<div class="relative z-50" *ngIf="earthquakeSummaryModal">
  <div
    class="fixed inset-0 bg-black opacity-80 transition-opacity"
    (click)="closeModal()"
  ></div>

  <div class="fixed inset-0 z-10 overflow-y-auto">
    <div
      class="
        flex
        min-h-full
        justify-center
        p-4
        text-center
        items-center
        xl:px-48
      "
    >
      <div
        class="
          relative
          transform
          overflow-hidden
          rounded-lg
          bg-blue-50
          px-4
          py-4
          text-left
          shadow-xl
          transition-all
          sm:my-8 sm:w-full sm:max-w-screen-lg
          xl:min-w-full
        "
      >
        <div class="bg-blue-50 px-4 pt-5">
          <div
            class="
              absolute
              top-0
              right-0
              cursor-pointer
              flex flex-col
              items-center
              mt-4
              mr-4
              text-white text-sm
              z-50
            "
          >
            <svg
              class="fill-current text-black"
              (click)="closeModal()"
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 18 18"
            >
              <path
                d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"
              ></path>
            </svg>
          </div>
          <div class="">
            <div class="mt-3 text-center">
              <div class="text-center mb-2">
                <h1 class="font-bold text-m lg:text-2xl text-gray-900">
                  Latest Earthquake Data Summary Dashboard
                </h1>
                <p class="italic lg:text-lg text-sm">
                  As of {{ todayString | date: 'fullDate' }}
                </p>
                <div class="w-full flex items-center justify-center">
                  <div
                    class="py-2 sm:py-4 md:py-2 bg-blue-50 shadow rounded-lg"
                  >
                    <div
                      class="
                        grid grid-cols-2
                        md:grid-cols-2
                        lg:grid-cols-2
                        px-4
                        xl:px-10
                        gap-y-8 gap-x-12
                        2xl:gap-x-28
                        items-center
                      "
                    >
                      <div class="w-full">
                        <p
                          class="
                            text-[8px]
                            md:text-xs
                            leading-none
                            text-black
                            uppercase
                            font-bold
                          "
                        >
                          Total Buildings
                        </p>
                        <p
                          class="
                            text-lg
                            sm:text-xl
                            md:text-2xl
                            lg:text-3xl
                            font-bold
                            leading-3
                            text-blue-700
                            mt-1
                            md:mt-1
                          "
                        >
                          {{ totalBuildings }}
                        </p>
                      </div>
                      <div class="w-full">
                        <p
                          class="
                            text-[8px]
                            md:text-xs
                            leading-none
                            text-black
                            uppercase
                            font-bold
                          "
                        >
                          Total Rshake Stations
                        </p>
                        <p
                          class="
                            text-lg
                            sm:text-xl
                            md:text-2xl
                            lg:text-3xl
                            font-bold
                            leading-3
                            text-blue-700
                            mt-1
                            md:mt-1
                          "
                        >
                          {{ totalStations }}
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="p-2">
          <div class="md:flex w-full">
            <div class="w-full">
              <input
                [(ngModel)]="searchValue"
                type="search"
                placeholder="Search"
                autocomplete="off"
                class="
                  rounded-2xl
                  w-full
                  py-2
                  px-2
                  bg-blue-50
                  border-4 border-blue-200
                  drop-shadow-sm
                  text-gray-700
                  leading-tight
                  focus:outline-none
                "
              />
              <h1
                class="pt-2 my-2 font-bold text-base lg:text-2xl text-blue-600"
              >
                List of buildings that surpassed the following thresholds:
              </h1>
              <nav class="tab-navigation">
                <ul
                  class="
                    tab-navigation
                    flex flex-wrap
                    text-[9.5px]
                    sm:text-xs
                    md:text-sm
                    lg:text-base
                    font-semibold
                    text-center text-blue-400
                    uppercase
                    dark:border-gray-700 dark:text-gray-400
                  "
                >
                  <li class="mr-2">
                    <label
                      for="select-all"
                      tabindex="1"
                      class="
                        inline-block
                        p-2
                        active
                        bg-blue-200
                        rounded-t-lg
                        text-black
                        hover:text-gray-600 hover:bg-blue-100
                        dark:hover:bg-gray-800
                        dark:hover:text-gray-300
                        dark:bg-gray-800
                        dark:text-gray-500
                      "
                      >ALL</label
                    >
                  </li>
                  <li class="mr-2">
                    <label
                      for="select-red"
                      tabindex="1"
                      class="
                        inline-block
                        p-2
                        rounded-t-lg
                        text-black
                        bg-noah-red-high
                        hover:text-gray-600 hover:bg-blue-100
                        active:bg-noah-red-high
                        dark:hover:bg-gray-800 dark:hover:text-gray-300
                      "
                      >ALERT RED
                    </label>
                  </li>
                  <li class="mr-2">
                    <label
                      for="select-orange"
                      tabindex="1"
                      class="
                        inline-block
                        p-2
                        rounded-t-lg
                        text-black
                        bg-noah-red-medium
                        hover:text-gray-600 hover:bg-blue-100
                        active:bg-noah-red-medium
                        dark:hover:bg-gray-800 dark:hover:text-gray-300
                      "
                      >ALERT ORANGE</label
                    >
                  </li>
                </ul>
              </nav>
              <section>
                <!-- TAB SECTION FOR ALL -->
                <div class="tab-all">
                  <input
                    type="radio"
                    name="tab-indicator"
                    id="select-all"
                    class="tab-indicator"
                    checked="checked"
                  />
                  <div class="tab-content">
                    <!-- <ng-container dataSummaryAll> -->
                    <!-- <div tabindex="0" class="justify-center">
                        <div
                          class="shadow-xl w-full z-10 overflow-hidden"
                          style="max-width: 1000px"
                        >
                          <div class="md:flex w-full">
                            <div class="w-full py-10 px-5 md:px-10">
                              <div class="flex justify-center gap-x-4 mb-4">
                                <div
                                  class="
                                    flex
                                    items-center
                                    justify-center
                                    bottom-0
                                  "
                                ></div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div> -->
                    <!-- </ng-container> -->
                    <!-- <ng-template #dataSummaryAll> -->
                    <div class="mt-0">
                      <div
                        class="
                          overflow-auto
                          rounded-tr-lg rounded-b-lg
                          shadow
                          overflow-y-auto
                        "
                        style="height: 405px"
                      >
                        <table class="w-full">
                          <thead class="bg-blue-200">
                            <tr class="text-left">
                              <th
                                class="
                                  top-0
                                  border-b border-gray-200
                                  bg-blue-200
                                  py-2
                                  text-base
                                  tracking-wide
                                  font-extrabold
                                  sticky
                                  whitespace-nowrap
                                "
                                *ngFor="let col of columns"
                              >
                                <div
                                  (click)="onHeaderColumnClick(col.key)"
                                  class="cursor-pointer inline-flex mx-2"
                                >
                                  {{ col.header }}
                                  <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="mr-1 h-5 w-5 text-left"
                                    viewBox="0 0 20 20"
                                    fill="currentColor"
                                  >
                                    <path
                                      d="M3 3a1 1 0 000 2h11a1 1 0 100-2H3zM3 7a1 1 0 000 2h5a1 1 0 000-2H3zM3 11a1 1 0 100 2h4a1 1 0 100-2H3zM13 16a1 1 0 102 0v-5.586l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 101.414 1.414L13 10.414V16z"
                                    />
                                  </svg>
                                </div>
                              </th>
                            </tr>
                          </thead>
                          <tbody class="divide-y divide-gray-100">
                            <tr
                              class="
                                hover:bg-gray-100
                                bg-white
                                even:bg-gray-50
                                mx-2
                              "
                              *ngFor="
                                let data of summaryAllData
                                  | sort: sortField:sortDirection
                                  | searchEqLocation: searchValue
                              "
                            >
                              <td
                                class="
                                  p-2
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  first-letter:capitalize
                                "
                              >
                                {{ data.bldg_name }}
                              </td>
                              <td
                                class="
                                  pr-5
                                  text-center text-base text-gray-700
                                  whitespace-nowrap
                                "
                              >
                                {{ data.rshake_station }}
                              </td>

                              <td
                                class="
                                  pr-5
                                  text-center text-base text-gray-700
                                  whitespace-nowrap
                                "
                              >
                                {{ data.floor_num }}
                              </td>
                              <ng-container
                                *ngIf="
                                  data.alert_level == 8;
                                  else displayAlertLevel
                                "
                              >
                                <td
                                  class="
                                    mx-2
                                    px-2
                                    text-base text-white
                                    whitespace-nowrap
                                    rounded-lg
                                    text-center
                                    bg-gray-900
                                  "
                                >
                                  Offline
                                </td>
                              </ng-container>

                              <ng-template #displayAlertLevel>
                                <td
                                  *ngIf="data.alert_level == 2"
                                  class="
                                    mx-2
                                    px-2
                                    text-base text-white
                                    whitespace-nowrap
                                    rounded-lg
                                    text-center
                                    bg-noah-red-high
                                  "
                                >
                                  {{ data.alert_level }}
                                </td>

                                <td
                                  *ngIf="data.alert_level == 1"
                                  class="
                                    mx-2
                                    px-2
                                    text-base text-white
                                    whitespace-nowrap
                                    rounded-lg
                                    text-center
                                    bg-noah-red-medium
                                  "
                                >
                                  {{ data.alert_level }}
                                </td>

                                <td
                                  *ngIf="data.alert_level == 0"
                                  class="
                                    mx-2
                                    px-2
                                    text-base text-white
                                    whitespace-nowrap
                                    rounded-lg
                                    text-center
                                    bg-noah-green-high
                                  "
                                >
                                  {{ data.alert_level }}
                                </td>
                              </ng-template>
                              <ng-container
                                *ngIf="
                                  data.floor_num == 1;
                                  else displayNoIntensity
                                "
                              >
                                <td
                                  class="
                                    pr-5
                                    text-center text-base text-gray-700
                                    whitespace-nowrap
                                  "
                                >
                                  {{ data.intensity }}
                                </td>
                              </ng-container>
                              <ng-template #displayNoIntensity>
                                <td
                                  class="
                                    pr-5
                                    text-base text-gray-700 text-center
                                    whitespace-nowrap
                                  "
                                >
                                  -
                                </td>
                              </ng-template>
                              <td
                                class="
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  text-center
                                "
                              >
                                {{ data.drift }} %
                              </td>
                              <td
                                class="
                                  pr-5
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  text-center
                                "
                              >
                                {{ data.acceleration }} cm/s
                              </td>
                              <td
                                class="
                                  pr-5
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  text-center
                                "
                              >
                                {{ data.displacement }} cm
                              </td>
                              <td
                                class="
                                  p-2
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  first-letter:capitalize
                                "
                              >
                                {{ data.remarks }}
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                    <!-- </ng-template> -->
                  </div>
                </div>

                <!-- TAB SECTION FOR RED -->
                <div class="tab-red">
                  <input
                    type="radio"
                    name="tab-indicator"
                    id="select-red"
                    class="tab-indicator"
                  />
                  <div class="tab-content">
                    <!-- <ng-container dataSummaryRed>
                      <div tabindex="0" class="justify-center">
                        <div
                          class="shadow-xl w-full z-10 overflow-hidden"
                          style="max-width: 1000px"
                        >
                          <div class="md:flex w-full">
                            <div class="w-full py-10 px-5 md:px-10">
                              <div class="flex justify-center gap-x-4 mb-4">
                                <div
                                  class="
                                    flex
                                    items-center
                                    justify-center
                                    bottom-0
                                  "
                                ></div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </ng-container> -->
                    <!-- <ng-template #dataSummaryRed> -->
                    <div class="mt-0">
                      <div
                        class="
                          overflow-auto
                          rounded-tr-lg rounded-b-lg
                          shadow
                          overflow-y-auto
                        "
                        style="height: 405px"
                      >
                        <table class="w-full">
                          <thead class="bg-noah-red-high">
                            <tr class="text-left">
                              <th
                                class="
                                  top-0
                                  border-b border-gray-200
                                  bg-noah-red-high
                                  py-2
                                  text-base
                                  tracking-wide
                                  text-left
                                  font-extrabold
                                  sticky
                                  whitespace-nowrap
                                "
                                *ngFor="let col of columns"
                              >
                                <div
                                  (click)="onHeaderColumnClick(col.key)"
                                  class="cursor-pointer inline-flex mx-2"
                                >
                                  {{ col.header }}
                                  <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="mr-1 h-5 w-5 text-left"
                                    viewBox="0 0 20 20"
                                    fill="currentColor"
                                  >
                                    <path
                                      d="M3 3a1 1 0 000 2h11a1 1 0 100-2H3zM3 7a1 1 0 000 2h5a1 1 0 000-2H3zM3 11a1 1 0 100 2h4a1 1 0 100-2H3zM13 16a1 1 0 102 0v-5.586l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 101.414 1.414L13 10.414V16z"
                                    />
                                  </svg>
                                </div>
                              </th>
                            </tr>
                          </thead>
                          <tbody class="divide-y divide-gray-100">
                            <tr
                              class="hover:bg-gray-100 bg-white even:bg-gray-50"
                              *ngFor="
                                let data of summaryRedAlertData
                                  | sort: sortField:sortDirection
                                  | searchEqLocation: searchValue
                              "
                            >
                              <td
                                class="
                                  p-2
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  first-letter:capitalize
                                "
                              >
                                {{ data.bldg_name }}
                              </td>
                              <td
                                class="
                                  pr-5
                                  text-center text-base text-gray-700
                                  whitespace-nowrap
                                "
                              >
                                {{ data.rshake_station }}
                              </td>

                              <td
                                class="
                                  pr-5
                                  text-center text-base text-gray-700
                                  whitespace-nowrap
                                "
                              >
                                {{ data.floor_num }}
                              </td>

                              <td
                                class="
                                  pr-5
                                  text-base text-gray-700 text-center
                                  whitespace-nowrap
                                "
                              >
                                {{ data.alert_level }}
                              </td>
                              <td
                                class="
                                  pr-5
                                  text-base text-gray-700 text-center
                                  whitespace-nowrap
                                "
                              >
                                -
                              </td>
                              <td
                                class="
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  text-center
                                "
                              >
                                {{ data.drift }} %
                              </td>
                              <td
                                class="
                                  pr-5
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  text-center
                                "
                              >
                                {{ data.acceleration }} cm/s
                              </td>
                              <td
                                class="
                                  pr-5
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  text-center
                                "
                              >
                                {{ data.displacement }} cm
                              </td>
                              <td
                                class="
                                  p-2
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  first-letter:capitalize
                                "
                              >
                                {{ data.remarks }}
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                    <!-- </ng-template> -->
                  </div>
                </div>

                <!-- TAB SECTION FOR ORANGE -->
                <div class="tab-orange">
                  <input
                    type="radio"
                    name="tab-indicator"
                    id="select-orange"
                    class="tab-indicator"
                  />
                  <div class="tab-content">
                    <!-- <ng-container dataSummaryOrange>
                      <div tabindex="0" class="justify-center">
                        <div
                          class="shadow-xl w-full z-10 overflow-hidden"
                          style="max-width: 1000px"
                        >
                          <div class="md:flex w-full">
                            <div class="w-full py-10 px-5 md:px-10">
                              <div class="flex justify-center gap-x-4 mb-4">
                                <div
                                  class="
                                    flex
                                    items-center
                                    justify-center
                                    bottom-0
                                  "
                                ></div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </ng-container> -->
                    <!-- <ng-template #dataSummaryOrange> -->
                    <div class="mt-0">
                      <div
                        class="
                          overflow-auto
                          rounded-tr-lg rounded-b-lg
                          shadow
                          overflow-y-auto
                        "
                        style="height: 405px"
                      >
                        <table class="w-full">
                          <thead class="bg-noah-red-medium">
                            <tr class="text-left">
                              <th
                                class="
                                  top-0
                                  border-b border-gray-200
                                  bg-noah-red-medium
                                  py-2
                                  text-base
                                  tracking-wide
                                  text-left
                                  font-extrabold
                                  sticky
                                  whitespace-nowrap
                                "
                                *ngFor="let col of columns"
                              >
                                <div
                                  (click)="onHeaderColumnClick(col.key)"
                                  class="cursor-pointer inline-flex mx-2"
                                >
                                  {{ col.header }}
                                  <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="mr-1 h-5 w-5 text-left"
                                    viewBox="0 0 20 20"
                                    fill="currentColor"
                                  >
                                    <path
                                      d="M3 3a1 1 0 000 2h11a1 1 0 100-2H3zM3 7a1 1 0 000 2h5a1 1 0 000-2H3zM3 11a1 1 0 100 2h4a1 1 0 100-2H3zM13 16a1 1 0 102 0v-5.586l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 101.414 1.414L13 10.414V16z"
                                    />
                                  </svg>
                                </div>
                              </th>
                            </tr>
                          </thead>
                          <tbody class="divide-y divide-gray-100">
                            <tr
                              class="hover:bg-gray-100 bg-white even:bg-gray-50"
                              *ngFor="
                                let data of summaryOrangeAlertData
                                  | sort: sortField:sortDirection
                                  | searchEqLocation: searchValue
                              "
                            >
                              <td
                                class="
                                  p-2
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  first-letter:capitalize
                                "
                              >
                                {{ data.bldg_name }}
                              </td>
                              <td
                                class="
                                  pr-5
                                  text-center text-base text-gray-700
                                  whitespace-nowrap
                                "
                              >
                                {{ data.rshake_station }}
                              </td>

                              <td
                                class="
                                  pr-5
                                  text-center text-base text-gray-700
                                  whitespace-nowrap
                                "
                              >
                                {{ data.floor_num }}
                              </td>

                              <td
                                class="
                                  pr-5
                                  text-base text-gray-700 text-center
                                  whitespace-nowrap
                                "
                              >
                                {{ data.alert_level }}
                              </td>
                              <ng-container
                                *ngIf="
                                  data.floor_num == 1;
                                  else displayNoIntensity
                                "
                              >
                                <td
                                  class="
                                    pr-5
                                    text-base text-gray-700 text-center
                                    whitespace-nowrap
                                  "
                                >
                                  {{ data.intensity }}
                                </td>
                              </ng-container>
                              <ng-template #displayNoIntensity>
                                <td
                                  class="
                                    pr-5
                                    text-base text-gray-700 text-center
                                    whitespace-nowrap
                                  "
                                >
                                  -
                                </td>
                              </ng-template>
                              <td
                                class="
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  text-center
                                "
                              >
                                {{ data.drift }} %
                              </td>
                              <td
                                class="
                                  pr-5
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  text-center
                                "
                              >
                                {{ data.acceleration }} cm/s
                              </td>
                              <td
                                class="
                                  pr-5
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  text-center
                                "
                              >
                                {{ data.displacement }} cm
                              </td>
                              <td
                                class="
                                  p-2
                                  text-base text-gray-700
                                  whitespace-nowrap
                                  first-letter:capitalize
                                "
                              >
                                {{ data.remarks }}
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                    <!-- </ng-template> -->
                  </div>
                </div>
              </section>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
