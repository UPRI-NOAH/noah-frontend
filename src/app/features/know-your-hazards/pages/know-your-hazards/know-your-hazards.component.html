<div class="top-0 fixed z-50 left-0 h-16 w-auto">
  <a class="flex max-w-xs p-2 items-center" routerLink="/">
    <img
      class="md:w-20 md:h-auto w-14"
      src="assets/icons/logo-noah.png"
      alt="Project NOAH"
    />
  </a>
</div>
<div class="w-full h-full min-h-screen bg-gray-100 flex flex-col md:flex-row">
  <!-- MOBILE VIEW -->
  <button
    (click)="isMenu = !isMenu"
    class="
      fixed
      p-2
      z-20
      bg-white
      text-gray-800
      shadow-2xl
      drop-shadow-2xl
      rounded-t-lg
      h-10
      bottom-0
      self-center
      md:hidden
    "
  >
    <svg
      class="animate-bounce w-6 h-6 text-gray-900"
      fill="none"
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      viewBox="0 0 24 24"
      stroke="currentColor"
    >
      <path
        d="M18.293 16.707L12 10.414l-6.293 6.293a1 1 0 11-1.414-1.414l7-7a1 1 0 011.414 0l7 7a1 1 0 01-1.414 1.414z"
        fill="#000"
        fill-rule="nonzero"
      />
    </svg>

    <span class="sr-only">Open menu</span>
  </button>
  <noah-search
    [searchTerm]="currentLocation$ | async"
    (selectPlace)="selectPlace($event)"
    class="
      fixed
      p-2
      z-20
      md:rounded-r-lg
      rounded-t-lg
      md:top-4
      self-center
      md:hidden
      w-2/3
    "
  ></noah-search>
  <nav
    class="
      block
      md:absolute
      order:last
      md:right-0 md:inset-y-0
      h-96
      p-4
      w-full
      md:w-1/4
      bottom-0
      fixed
      bg-white
      flex-none
      md:min-h-screen
      z-50
      overflow-y-auto
      shadow-inner
      rounded-t-md
    "
    *ngIf="isMenu"
    id="sidebar"
  >
    <ng-container *ngIf="isKYHPage$ | async; else hazardTemplate">
      <!-- MAPBOX LOGOS -->
      <div class="flex" *ngIf="isMenu">
        <div class="absolute p-2 z-20 -left-2 top-0 md:hidden">
          <a class="fixed max-w-xs items-center">
            <div class="mapboxgl-ctrl-bottom-left mb-2">
              <div class="mapboxgl-ctrl">
                <a
                  class="mapboxgl-ctrl-logo"
                  target="_blank"
                  rel="noopener nofollow"
                  href="https://www.mapbox.com/"
                  aria-label="Mapbox logo"
                >
                </a>
              </div>
            </div>
          </a>
        </div>
      </div>

      <div class="flex" *ngIf="isMenu">
        <div class="absolute p-1 z-20 right-0 top-0 md:hidden">
          <a class="fixed max-w-xs items-center">
            <div class="mapboxgl-ctrl-bottom-right -right-2 mb-2">
              <div class="mapboxgl-ctrl mapboxgl-ctrl-attrib mapboxgl-compact">
                <div
                  class="cursor-pointer"
                  (click)="isList === 1 ? (isList = 0) : (isList = 1)"
                >
                  <div
                    class="
                      mapboxgl-ctrl-attrib-button
                      bg-gray-200
                      z-50
                      focus:outline-none
                    "
                    type="button"
                    title="Toggle attribution"
                    aria-label="Toggle attribution"
                  ></div>
                  <div class="absolute z-40 right-0 -bottom-1 pt-2">
                    <div class="rounded-lg bg-white w-72 mt-4">
                      <ul *ngIf="isList === 1">
                        <li class="p-1 text-xs flex">
                          <a
                            href="https://www.mapbox.com/about/maps/"
                            target="_blank"
                            title="Mapbox"
                            aria-label="Mapbox"
                            role="listitem"
                          >
                            <div class="mr-1 font-mono">© Mapbox</div></a
                          >
                          <a
                            href="http://www.openstreetmap.org/about/"
                            target="_blank"
                            title="OpenStreetMap"
                            aria-label="OpenStreetMap"
                            role="listitem"
                          >
                            <div class="mr-1 font-mono">© OpenStreetMap</div></a
                          >
                          <a
                            href="https://www.mapbox.com/map-feedback/"
                            target="_blank"
                            title="Improve this map"
                            aria-label="Improve this map"
                            role="listitem"
                          >
                            <div class="font-mono">Improve this map</div></a
                          >
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <!-- MAPBOX LOGOS -->
      <div (click)="isMenu = !isMenu" class="text-black ml-8 cursor-pointer">
        <button
          class="
            absolute
            p-2
            z-20
            rounded-sm
            text-gray-800
            right-4
            top-4
            md:hidden
          "
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 md:hidden"
            viewBox="0 0 100 125"
          >
            <switch>
              <g>
                <path
                  d="M56.9 78.7L95.4 33c4.9-5.8.8-14.8-6.9-14.8h-77C3.9 18.2-.3 27.1 4.6 33l38.5 45.7c3.6 4.2 10.2 4.2 13.8 0z"
                />
              </g>
            </switch>
          </svg>
        </button>
      </div>

      <div>
        <h4 class="text-2xl font-bold leading-tight mt-6 pb-2">
          Hazard Levels In Your Area
        </h4>
        <div class="pt-4">
          <div
            class="
              flex flex-col
              p-2
              bg-white
              shadow-md
              hover:shodow-lg
              rounded-2xl
              hover:bg-gray-100
            "
            (click)="viewHazardLayer('flood')"
            id="menu"
            role="button"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <img
                  class="h-auto w-14"
                  src="assets/images/flood.svg"
                  alt="flood"
                />
                <div class="flex flex-col ml-3">
                  <div class="font-bold leading-none" role="button">
                    Flood Hazard Level
                  </div>
                  <p
                    class="uppercase font-bold text-xl leading-none mt-2"
                    role="button"
                    [ngClass]="'text-noah-red-' + (floodRiskLevel$ | async)"
                  >
                    {{ floodRiskLevel$ | async }}
                  </p>
                </div>
              </div>
              <p class="text-sm w-4 text-gray-600 leading-none mt-1">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000">
                  <path
                    d="M283.7 10l-58.4 58.4L656 500 225.3 931.6l58.4 58.4 491-490-491-490z"
                  />
                </svg>
              </p>
            </div>
          </div>
        </div>

        <div class="pt-4">
          <div
            class="
              flex flex-col
              p-2
              bg-white
              shadow-md
              hover:shodow-lg
              rounded-2xl
              hover:bg-gray-100
            "
            (click)="viewHazardLayer('landslide')"
            id="menu"
            role="button"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <img
                  class="h-auto w-14"
                  src="assets/images/landslide.svg"
                  alt="landslide"
                />
                <div class="flex flex-col ml-3">
                  <div class="font-bold leading-none" role="button">
                    Landslide Hazard Level
                  </div>
                  <p
                    class="uppercase font-bold text-xl leading-none mt-2"
                    role="button"
                    [ngClass]="'text-noah-red-' + (landslideRiskLevel$ | async)"
                  >
                    {{ landslideRiskLevel$ | async }}
                  </p>
                </div>
              </div>
              <p class="text-sm w-4 text-gray-600 leading-none mt-1">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000">
                  <path
                    d="M283.7 10l-58.4 58.4L656 500 225.3 931.6l58.4 58.4 491-490-491-490z"
                  />
                </svg>
              </p>
            </div>
          </div>
        </div>

        <div class="pt-4">
          <div
            class="
              flex flex-col
              p-2
              bg-white
              shadow-md
              hover:shodow-lg
              rounded-2xl
              hover:bg-gray-100
            "
            (click)="viewHazardLayer('storm-surge')"
            id="menu"
            role="button"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <img
                  class="h-auto w-14"
                  src="assets/images/storm-surge.svg"
                  alt="storm-surge"
                />
                <div class="flex flex-col ml-3">
                  <div class="font-bold leading-none" role="button">
                    Storm Surge Hazard Level
                  </div>
                  <p
                    class="uppercase font-bold text-xl leading-none mt-2"
                    role="button"
                    [ngClass]="
                      'text-noah-red-' + (stormSurgeRiskLevel$ | async)
                    "
                  >
                    {{ stormSurgeRiskLevel$ | async }}
                  </p>
                </div>
              </div>
              <p class="text-sm w-4 text-gray-600 leading-none mt-1">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000">
                  <path
                    d="M283.7 10l-58.4 58.4L656 500 225.3 931.6l58.4 58.4 491-490-491-490z"
                  />
                </svg>
              </p>
            </div>
          </div>
        </div>

        <div class="m-6">
          <p class="font-bold text-medium">Hazards shown are:</p>
          <ol>
            <li>1) 100-year rain return for floods;</li>
            <li>2) Shallow and structurally-controlled landslides;</li>
            <li class="mb-2">3) 5-meters for storm surges.</li>
            <li>
              For more information, please go to the
              <a routerLink="/noah-playground" class="text-primary"
                >NOAH Playground.</a
              >
            </li>
          </ol>

          <p class="mt-2">
            These hazard levels are based on flood simulations as well as
            satellite and historical data.
          </p>
          <p>Click <a class="text-primary">here</a> for the methods used.</p>
        </div>
        <noah-critical-facilities-kyh></noah-critical-facilities-kyh>
      </div>
    </ng-container>
  </nav>
  <!-- MOBILE VIEW -->

  <!-- DESKTOP VIEW -->
  <nav
    class="
      hidden
      md:block md:absolute
      order:last
      md:right-0 md:inset-y-0
      h-96
      p-4
      w-full
      md:w-1/4
      bottom-0
      fixed
      bg-white
      flex-none
      md:min-h-screen
      z-50
      overflow-y-auto
      shadow-2xl
    "
    *ngIf="isOpen"
  >
    <ng-container *ngIf="isKYHPage$ | async; else hazardTemplate">
      <noah-search
        [searchTerm]="currentLocation$ | async"
        (selectPlace)="selectPlace($event)"
        class="w-full mt-4 hidden md:block relative"
      >
      </noah-search>
      <div>
        <h4 class="text-2xl font-bold leading-tight mt-6 pb-2">
          Hazard Levels In Your Area
        </h4>
        <div class="pt-4">
          <div
            class="
              flex flex-col
              p-2
              bg-white
              shadow-md
              hover:shodow-lg
              rounded-2xl
              hover:bg-gray-100
            "
            (click)="viewHazardLayer('flood')"
            id="menu"
            role="button"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <img
                  class="h-auto w-14"
                  src="assets/images/flood.svg"
                  alt="flood"
                />
                <div class="flex flex-col ml-3">
                  <div class="font-bold leading-none" role="button">
                    Flood Hazard Level
                  </div>
                  <p
                    class="uppercase font-bold text-xl leading-none mt-2"
                    role="button"
                    [ngClass]="'text-noah-red-' + (floodRiskLevel$ | async)"
                  >
                    {{ floodRiskLevel$ | async }}
                  </p>
                  <small>{{ floodCaption$ | async }}</small>
                </div>
              </div>
              <p class="text-sm w-4 text-gray-600 leading-none mt-1">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000">
                  <path
                    d="M283.7 10l-58.4 58.4L656 500 225.3 931.6l58.4 58.4 491-490-491-490z"
                  />
                </svg>
              </p>
            </div>
          </div>
        </div>

        <div class="pt-4">
          <div
            class="
              flex flex-col
              p-2
              bg-white
              shadow-md
              hover:shodow-lg
              rounded-2xl
              hover:bg-gray-100
            "
            (click)="viewHazardLayer('landslide')"
            id="menu"
            role="button"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <img
                  class="h-auto w-14"
                  src="assets/images/landslide.svg"
                  alt="flood"
                />
                <div class="flex flex-col ml-3">
                  <div class="font-bold leading-none" role="button">
                    Landslide Hazard Level
                  </div>
                  <p
                    class="uppercase font-bold text-xl leading-none mt-2"
                    role="button"
                    [ngClass]="'text-noah-red-' + (landslideRiskLevel$ | async)"
                  >
                    {{ landslideRiskLevel$ | async }}
                  </p>
                </div>
              </div>
              <p class="text-sm w-4 text-gray-600 leading-none mt-1">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000">
                  <path
                    d="M283.7 10l-58.4 58.4L656 500 225.3 931.6l58.4 58.4 491-490-491-490z"
                  />
                </svg>
              </p>
            </div>
          </div>
        </div>

        <div class="pt-4">
          <div
            class="
              flex flex-col
              p-2
              bg-white
              shadow-md
              hover:shodow-lg
              rounded-2xl
              hover:bg-gray-100
            "
            (click)="viewHazardLayer('storm-surge')"
            id="menu"
            role="button"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <img
                  class="h-auto w-14"
                  src="assets/images/storm-surge.svg"
                  alt="flood"
                />
                <div class="flex flex-col ml-3">
                  <div class="font-bold leading-none" role="button">
                    Storm Surge Hazard Level
                  </div>
                  <p
                    class="uppercase font-bold text-xl leading-none mt-2"
                    role="button"
                    [ngClass]="
                      'text-noah-red-' + (stormSurgeRiskLevel$ | async)
                    "
                  >
                    {{ stormSurgeRiskLevel$ | async }}
                  </p>
                </div>
              </div>
              <p class="text-sm w-4 text-gray-600 leading-none mt-1">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000">
                  <path
                    d="M283.7 10l-58.4 58.4L656 500 225.3 931.6l58.4 58.4 491-490-491-490z"
                  />
                </svg>
              </p>
            </div>
          </div>
        </div>

        <div class="m-6">
          <p class="font-bold pb-2">Hazards shown are:</p>

          <ol>
            <li>1) 100-year rain return for floods</li>
            <li>2) Shallow and structurally-controlled landslides</li>
            <li class="mb-2">3) 5 meters for storm surges</li>
            <li>
              For more information, please go to the
              <a
                routerLink="/noah-playground"
                target="_blank"
                class="text-primary"
                >NOAH Playground.</a
              >
            </li>
          </ol>

          <p class="mt-2">
            These hazard levels are based on flood simulations as well as
            satellite and historical data. Click
            <a routerLink="/bibliography" target="_blank" class="text-primary"
              >here</a
            >
            for the methods used.
          </p>
        </div>

        <noah-critical-facilities-kyh></noah-critical-facilities-kyh>
      </div>
    </ng-container>
  </nav>
  <!-- DESKTOP VIEW -->

  <main
    class="
      block
      w-full
      md:w-9/12 md:fixed
      bg-gray-100
      order-1
      md:min-h-screen
      z-10
    "
  >
    <noah-map-kyh></noah-map-kyh>
  </main>
</div>

<ng-template #hazardTemplate>
  <!-- FLOODING -->
  <noah-flood-kyh *ngIf="isFlood$ | async"></noah-flood-kyh>

  <!-- LANDSLIDE -->
  <noah-landslide-kyh *ngIf="isLandSlide$ | async"></noah-landslide-kyh>

  <!-- STORMSURGE -->
  <noah-storm-surge-kyh *ngIf="isStormSurge$ | async"></noah-storm-surge-kyh>
</ng-template>
